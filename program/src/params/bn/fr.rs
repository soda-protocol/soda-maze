use crate::bn::{Fp256, Fp256Parameters, FpParameters, BigInteger256 as BigInteger};

pub type Fr = Fp256<FrParameters>;

pub struct FrParameters;

impl Fp256Parameters for FrParameters {}

impl FpParameters for FrParameters {
    type BigInteger = BigInteger;

    /// MODULUS = 21888242871839275222246405745257275088548364400416034343698204186575808495617
    const MODULUS: Self::BigInteger = BigInteger::new([
        4891460686036598785,
        2896914383306846353,
        13281191951274694749,
        3486998266802970665,
    ]);

    const MODULUS_BITS: u32 = 254;

    const CAPACITY: u32 = Self::MODULUS_BITS - 1;

    const REPR_SHAVE_BITS: u32 = 2;

    /// R = pow(2, 320) % MODULUS
    ///   = 6350874878119819312338956282401532410528162663560392320966563075034087161851
    const R: Self::BigInteger = BigInteger::new([
        12436184717236109307,
        3962172157175319849,
        7381016538464732718,
        1011752739694698287,
    ]);

    /// R2 = R * R % MODULUS
    ///    = 944936681149208446651664254269745548490766851729442924617792859073125903783
    const R2: Self::BigInteger = BigInteger::new([
        1997599621687373223,
        6052339484930628067,
        10108755138030829701,
        150537098327114917,
    ]);

    /// INV = (-MODULUS) ^ {-1} % pow(2, 64) = 14042775128853446655
    const INV: u64 = 14042775128853446655;

    /// GENERATOR = 5
    const GENERATOR: Self::BigInteger = BigInteger::new([
        1949230679015292902,
        16913946402569752895,
        5177146667339417225,
        1571765431670520771,
    ]);

    /// (MODULUS - 1)/2 =
    /// 10944121435919637611123202872628637544274182200208017171849102093287904247808
    const MODULUS_MINUS_ONE_DIV_TWO: Self::BigInteger = BigInteger::new([
        11669102379873075200,
        10671829228508198984,
        15863968012492123182,
        1743499133401485332,
    ]);

    // T and T_MINUS_ONE_DIV_TWO, where r - 1 = 2^s * t

    /// T = (MODULUS - 1) / 2^s =
    /// 81540058820840996586704275553141814055101440848469862132140264610111
    const T: Self::BigInteger = BigInteger::new([
        11211439779908376895,
        1735440370612733063,
        1376415503089949544,
        12990080814,
    ]);

    /// (T - 1) / 2 =
    /// 40770029410420498293352137776570907027550720424234931066070132305055
    const T_MINUS_ONE_DIV_TWO: Self::BigInteger = BigInteger::new([
        14829091926808964255,
        867720185306366531,
        688207751544974772,
        6495040407,
    ]);
}